LoginRequest:
  type: object
  description: Login with either email + password or username + password
  oneOf:
    - type: object
      description: Login via email
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          example: user@example.com
        password:
          type: string
          format: password
          example: secret123
    - type: object
      description: Login via username
      required: [username, password]
      properties:
        username:
          type: string
          example: user123
        password:
          type: string
          format: password
          example: secret123

# 200 OK — trusted device, MFA skipped
LoginSuccessResponse:
  type: object
  description: Successful login; refresh token is set as an HTTP-only cookie.
  properties:
    success:
      type: boolean
      example: true
    accessToken:
      type: string
      description: Short-lived JWT access token
      example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
    mfaSkipped:
      type: boolean
      description: True if a valid trusted-device cookie allowed skipping OTP
      example: true
  required: [success, accessToken]

# 202 Accepted — MFA required
LoginOTPRequiredResponse:
  type: object
  description: Credentials valid; an OTP was sent and must be verified to finish login.
  properties:
    success:
      type: boolean
      example: true
    requiresOTP:
      type: boolean
      example: true
    delivery:
      type: string
      description: Channel used to deliver OTP
      enum: [email, sms]
      example: email
    to:
      type: string
      description: Masked destination (email or phone)
      example: u***r@example.com
    hint:
      type: string
      example: Submit OTP to /v1/auth/otp/verify to complete login
  required: [success, requiresOTP, delivery, to]
